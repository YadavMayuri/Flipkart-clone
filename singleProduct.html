<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>flipkart</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/174a9c1444.js" crossorigin="anonymous"></script>
</head>
<body>
    <div id="singlPro-screen">
        <div class="main-navbar-wrapper">
            <div class="navbar">
                <div class="left-navbar">
                    <div class="logo-wrap">
                        <div class="flipcart-txt-img">
                            <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/flipkart-plus_8d85f4.png"
                                alt="">
                        </div>
                        <div class="bottom-img-wrap">
                            <span class="explore-txt">Explore</span>
                            <span class="plus-txt">Plus</span>
                            <span class="icon-img">
                                <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/plus_aef861.png"
                                    alt="">
                            </span>
                        </div>
                    </div>
                    <div class="search-wrap">
                        <input type="text" placeholder="Search for products,brands and more">
                        <i class="fa-solid fa-magnifying-glass"></i>
                    </div>

                </div>

                <div class="right-navbar">
                    <div class="login-btn" id="switch" onclick="window.location.href='./register.html'">Login</div>
                    <div class="become-seller">Become a Seller</div>
                    <div class="more-wrap">
                        <span class="more-sp">More</span>
                        <span><i class="fa-solid fa-angle-down"></i></span>
                    </div>
                    <div class="cart-nav-wrap">
                        <span><i class="fa-solid fa-cart-shopping"></i></span>
                        <span>Cart</span>
                    </div>
                    <div id="logout"> </div>
                </div>
            </div>
        </div>

        <div class="products-wrapper" >
            <div class="Singleproduct">
                <div class="product-image-wrapper" >
                   <div id="singleProductImage"></div>
                </div>

                <div class="product-info-wrapper">
                    <div class="productBrandName" id="for-product-brand"> </div>
                    <div class="proname-fcart-assured">
                        <div class="productName" id="for-product-name" > </div>
                        <div class="f-assured-img-wrap">
                            <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/fa_62673a.png"
                                alt="">
                        </div>
                    </div>
                    <div class="price-info-wrap">
                        <span class="actual-p-price" id="for-product-price">₹ </span>
                        <span class="strike-price">₹1,000</span>
                        <span class="discount-txt">50% off</span>
                    </div>
                    <div class="product-size">Size : <span class="size-info"> XL, XXL, 3XL, 4XL</span></div>

                    <div class="addcartbtn" id="for-add-to-cart-btn"> </div>
                </div>



            </div>
        </div>


    </div>
    

    <script>
         window.onload = function () {
            // alert("working")
            var currentUser = JSON.parse(localStorage.getItem("FlipcartCurrentUser"))
            // console.log(currentUser,"current user");
            if (!!currentUser) {
                // alert(currenUser,"username")
                var logoutDiv = document.getElementById("logout")
                var divfromHtml = document.getElementById("switch");
                // console.log(divfromHtml, "divfromhtml");
                // var h1=document.createElement("h1");
                // h1.innerText="Mayuri"
                // divfromHtml.append(h1)
                var button = '<span class="lgbtn-wrap"><i class="fa-solid fa-arrow-right-from-bracket id=logout-icon"></i> <button onclick="logout()" class="logout-button-txt">Logout</button></span>'
                var name = `<span>${currentUser.userName}</span>`;
                divfromHtml.innerHTML = name;
                logoutDiv.innerHTML = button;

            }

            var product = JSON.parse(localStorage.getItem("FlipkartCurrentProduct"));

            var divToAppendProductImage = document.getElementById("singleProductImage");
            var divToAppendProductBrand = document.getElementById("for-product-brand");
            var divToAppendProductName = document.getElementById("for-product-name");
            var divToAppendProductprice = document.getElementById("for-product-price");
            var divToAppendAddtocart = document.getElementById("for-add-to-cart-btn")




            var structure = ` <img src='${product.proImage} ' />`
            var productBrand=`${product.ProBrand} `
            var productName = `${product.proName}`
            var productprice = `${product.proPrice}`
            var addtocart = ` <button onclick='addCart(${JSON.stringify(product)})' >Add to cart</button>`
            
            divToAppendProductImage.innerHTML = structure;
            divToAppendProductBrand.innerHTML = productBrand;
            divToAppendProductName.innerHTML = productName;
            divToAppendProductprice.innerHTML = productprice;
            divToAppendAddtocart.innerHTML = addtocart;

        }

        function addCart(product) {
            // alert("Adding to cart")
            var currentUser = JSON.parse(localStorage.getItem("FlipcartCurrentUser"))
            // console.log(currentUser.userEmail);
            var userdata = JSON.parse(localStorage.getItem("FlipkartUsers"));
            for (var i = 0; i < userdata.length; i++) {
                if (currentUser.userEmail == userdata[i].userEmail) {
                    // alert("got")
                    if (userdata[i].cartProducts === undefined) {
                        // userdata[i].cartProducts = "hello"

                        userdata[i].cartProducts = [product]
                    } else {
                        userdata[i].cartProducts.push(product);
                    }
                    alert("Product added to cart")
                    window.location.href = "./cart.html"
                }
            }
            localStorage.setItem("FlipkartUsers", JSON.stringify(userdata))
        }

        
        function logout() {
            alert("Logout successful.")
            localStorage.removeItem("FlipcartCurrentUser")
            window.location.reload()


        }
    </script>
</body>
</html>